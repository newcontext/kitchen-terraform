<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport"
          content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="msapplication-config" content="browserconfig.xml" />
    <title>Provisioner</title>
    <link rel="apple-touch-icon" sizes="180x180" href="/kitchen-terraform/apple-touch-icon-180x180-precomposed.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/kitchen-terraform/apple-touch-icon-152x152-precomposed.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/kitchen-terraform/apple-touch-icon-144x144-precomposed.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/kitchen-terraform/apple-touch-icon-114x114-precomposed.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/kitchen-terraform/apple-touch-icon-72x72-precomposed.png">
    <link rel="apple-touch-icon" href="/kitchen-terraform/apple-touch-icon-precomposed.png">
    <link rel="icon" type="image/png" sizes="196x196" href="/kitchen-terraform/favicon-196x196.png">
    <link rel="icon" type="image/png" sizes="160x160" href="/kitchen-terraform/favicon-160x160.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/kitchen-terraform/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/kitchen-terraform/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/kitchen-terraform/favicon-16x16.png">
    <link rel="shortcut icon" href="/kitchen-terraform/favicon.png">
    <link rel="icon" type="image/ico" href="/kitchen-terraform/favicon.ico">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous">
    <link href="/kitchen-terraform/stylesheets/highlighting.css" rel="stylesheet" />
    <link href="/kitchen-terraform/stylesheets/material.css" rel="stylesheet" />
    <link href="/kitchen-terraform/stylesheets/site.css" rel="stylesheet" />
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ" crossorigin="anonymous"></script>
    <script src="/kitchen-terraform/javascripts/site.js"></script>
  </head>
  <body>
    <nav class="navbar fixed-top navbar-expand-lg navbar-light header">
      <img src="/kitchen-terraform/images/kitchen_terraform_logo.png" class="d-inline-block" style="vertical-align: sub; margin-left: 10px;" width="18" height="18" alt="Kitchen-Terraform logo" />
      <a href="/kitchen-terraform/" class="navbar-brand" style="padding-left: 5px;">Kitchen-Terraform</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav mr-auto">
          <li class="nav-item">
            <a href="/kitchen-terraform/getting_started.html" class="nav-link">Getting Started</a>
          </li>
          <li class="nav-item">
            <a href="/kitchen-terraform/tutorials/" class="nav-link">Tutorials</a>
          </li>
          <li class="nav-item">
            <a href="/kitchen-terraform/documentation/" class="nav-link">Documentation</a>
          </li>
          <li class="nav-item">
            <a href="/kitchen-terraform/community/" class="nav-link">Community</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/newcontext-oss/kitchen-terraform">
              <img src="/kitchen-terraform/images/github.png" class="d-inline-block" style="vertical-align: sub;" width="18" height="18" alt="GitHub logo" /> Contribute
            </a>
          </li>
        </ul>
      </div>
    </nav>
    <div class="content text-left">
      <h1 id="kitchen-terraform-provisioner">Kitchen-Terraform Provisioner</h1>

<p>The provisioner applies changes to the Terraform state based on the
configuration of the root module.</p>

<h2 id="commands">Commands</h2>

<p>The following command-line actions are provided by the provisioner:</p>

<ul>
  <li>converge</li>
</ul>

<h3 id="converge">converge</h3>

<p>A Kitchen instance is converged through the following steps:</p>

<ul>
  <li>selecting the test Terraform workspace</li>
  <li>updating the Terraform dependency modules</li>
  <li>validating the Terraform root module</li>
  <li>applying the Terraform state changes</li>
  <li>retrieving the Terraform output</li>
</ul>

<p><em>Example</em>:</p>

<div class="highlight"><pre class="syntax-highlight plaintext"><code>$ kitchen help converge
$ kitchen converge default-ubuntu
</code></pre></div>
<h4 id="selecting-the-test-terraform-workspace">Selecting the Test Terraform Workspace</h4>

<p>The provisioner selects the workspace by running a command like the 
following example:</p>

<div class="highlight"><pre class="syntax-highlight plaintext"><code>terraform workspace select &lt;name&gt;
</code></pre></div>
<h4 id="updating-the-terraform-dependency-modules">Updating the Terraform Dependency Modules</h4>

<p>The provisioner updates the dependency modules by running a command 
like the following example:</p>

<div class="highlight"><pre class="syntax-highlight plaintext"><code>terraform get -update &lt;directory&gt;
</code></pre></div>
<h4 id="validating-the-terraform-root-module">Validating the Terraform Root Module</h4>

<p>The provisioner validates the root module by running a command like the 
following example, where the options are controlled by configuration 
attributes of the <a href="/kitchen-terraform/documentation/driver.html">driver</a>:</p>

<div class="highlight"><pre class="syntax-highlight plaintext"><code>terraform validate \
  [-no-color] \
  [-var=&lt;variables.first&gt;...] \
  [-var-file=&lt;variable_files.first&gt;...] \
  &lt;directory&gt;
</code></pre></div>
<h4 id="applying-the-terraform-state-changes">Applying the Terraform State Changes</h4>

<p>The provisioner applies the state changes by running a command like the 
following example, where the options are controlled by configuration 
attributes of the <a href="/kitchen-terraform/documentation/driver.html">driver</a>:</p>

<div class="highlight"><pre class="syntax-highlight plaintext"><code>terraform apply \
  -auto-approve=true \
  -input=false \
  -refresh=true \
  -lock-timeout=&lt;lock_timeout&gt;s \
  -lock=&lt;lock&gt; \
  -parallelism=&lt;parallelism&gt; \
  [-no-color] \
  [-var-file=&lt;variable_files.first&gt;...] \
  [-var=&lt;variables.first&gt;...] \
  &lt;directory&gt;
</code></pre></div>
<h4 id="retrieving-the-terraform-output">Retrieving the Terraform Output</h4>

<p>The provisioner retrieves the outputs by running a command like the 
following example:</p>

<div class="highlight"><pre class="syntax-highlight plaintext"><code>terraform output -json
</code></pre></div>
<h2 id="configuration">Configuration</h2>

<p>Within the
<a href="http://kitchen.ci/docs/getting-started/kitchen-yml">Kitchen configuration file</a>, 
the <code>provisioner</code> mapping must be declared along with the plugin name:</p>

<div class="highlight"><pre class="syntax-highlight yaml"><code><span class="na">provisioner</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">terraform</span>
</code></pre></div>
<h3 id="attributes">Attributes</h3>

<p>The provisioner has no configuration attributes, but rather relies on 
the attributes of the <a href="/kitchen-terraform/documentation/driver.html">driver</a>.</p>

    </div>
    <footer class="footer">
      <div class="container">
        <span class="text-muted">Community driven, created and maintained by
          <a href="http://newcontext.com" style="color: #32c850;">
            <img src="/kitchen-terraform/images/newcontext_logo.png" class="d-inline-block" style="vertical-align: sub;" width="30" height="24" alt="New Context, Inc. logo" />
            New Context, Inc.
          </a>
        </span>
      </div>
    </footer>
  </body>
</html>
